# æ¨¡å‹æä¾›å•†é…ç½®æŒ‡å—

## æ¦‚è¿°

MimirQ ç°åœ¨æ”¯æŒç±»ä¼¼ Dify çš„æ¨¡å‹æä¾›å•†å¯è§†åŒ–é…ç½®ç•Œé¢,è®©ä½ å¯ä»¥è½»æ¾ç®¡ç†å¤šä¸ªä¸»æµ LLM æœåŠ¡å•†çš„ API é…ç½®ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

### âœ¨ æ”¯æŒçš„æ¨¡å‹æä¾›å•†

æˆ‘ä»¬æ”¯æŒä»¥ä¸‹ 8 ä¸ªä¸»æµ AI æ¨¡å‹æä¾›å•†:

| æä¾›å•† | å›¾æ ‡ | æè¿° | æ¨¡å‹ç¤ºä¾‹ |
|--------|------|------|---------|
| **OpenAI** | ğŸŸ¢ | GPT-4, GPT-3.5 ç³»åˆ—æ¨¡å‹ | GPT-4 Turbo, GPT-3.5 Turbo, Embedding 3 |
| **Anthropic** | ğŸŸ  | Claude 3 ç³»åˆ—æ¨¡å‹ | Claude 3 Opus, Sonnet, Haiku |
| **DeepSeek** | ğŸ”µ | é«˜æ€§ä»·æ¯”çš„ä¸­æ–‡å¤§æ¨¡å‹ | DeepSeek Chat, DeepSeek Coder |
| **æ™ºè°± AI** | ğŸŸ£ | GLM-4 ç³»åˆ—æ¨¡å‹ | GLM-4, GLM-4 Air |
| **é€šä¹‰åƒé—®** | ğŸ”· | é˜¿é‡Œäº‘å¤§æ¨¡å‹æœåŠ¡ | Qwen Turbo, Qwen Plus, Qwen Max |
| **Moonshot AI** | ğŸŒ™ | Kimi é•¿æ–‡æœ¬å¤§æ¨¡å‹ | Moonshot 8K/32K/128K |
| **Ollama** | âš« | æœ¬åœ°éƒ¨ç½²çš„å¼€æºæ¨¡å‹ | Llama 2, Mistral, Qwen |
| **æœ¬åœ° Embedding** | ğŸŸ¢ | BGE ä¸­æ–‡å‘é‡æ¨¡å‹ | BGE Large/Base ZH v1.5 |

## ä½¿ç”¨æ–¹æ³•

### 1. è®¿é—®è®¾ç½®é¡µé¢

ç‚¹å‡»å·¦ä¾§å¯¼èˆªæ çš„ **è®¾ç½®** å›¾æ ‡è¿›å…¥é…ç½®é¡µé¢ã€‚

### 2. é€‰æ‹©æä¾›å•†

åœ¨ç½‘æ ¼å¸ƒå±€ä¸­æ‰¾åˆ°ä½ æƒ³è¦é…ç½®çš„æä¾›å•†å¡ç‰‡,ç‚¹å‡»å¡ç‰‡æˆ– "ç«‹å³é…ç½®" æŒ‰é’®ã€‚

### 3. å¡«å†™é…ç½®ä¿¡æ¯

åœ¨å¼¹å‡ºçš„é…ç½®å¯¹è¯æ¡†ä¸­å¡«å†™:

- **API Key** (å¿…å¡«): ä»æä¾›å•†å®˜ç½‘è·å–
- **API Base URL** (å¯é€‰): é»˜è®¤å·²å¡«å†™,æ”¯æŒè‡ªå®šä¹‰ä»£ç†
- **é«˜çº§è®¾ç½®** (å¯é€‰):
  - Temperature: æ§åˆ¶è¾“å‡ºéšæœºæ€§ (0-2)
  - Max Tokens: æœ€å¤§è¾“å‡º token æ•°
  - Timeout: è¯·æ±‚è¶…æ—¶æ—¶é—´ (ç§’)

### 4. æµ‹è¯•è¿æ¥

ç‚¹å‡» "æµ‹è¯•è¿æ¥" æŒ‰é’®éªŒè¯ API Key æ˜¯å¦æœ‰æ•ˆã€‚

### 5. ä¿å­˜é…ç½®

ç‚¹å‡» "ä¿å­˜é…ç½®" æŒ‰é’®å®Œæˆè®¾ç½®ã€‚é…ç½®æˆåŠŸå,å¡ç‰‡å³ä¸Šè§’ä¼šæ˜¾ç¤º âœ… æ ‡è®°ã€‚

## å®˜æ–¹æ–‡æ¡£é“¾æ¥

| æä¾›å•† | è·å– API Key | API æ–‡æ¡£ |
|--------|-------------|----------|
| OpenAI | [platform.openai.com/api-keys](https://platform.openai.com/api-keys) | [æ–‡æ¡£](https://platform.openai.com/docs) |
| Anthropic | [console.anthropic.com](https://console.anthropic.com/) | [æ–‡æ¡£](https://docs.anthropic.com) |
| DeepSeek | [platform.deepseek.com](https://platform.deepseek.com/) | [æ–‡æ¡£](https://platform.deepseek.com/docs) |
| æ™ºè°± AI | [open.bigmodel.cn](https://open.bigmodel.cn/) | [æ–‡æ¡£](https://open.bigmodel.cn/dev/api) |
| é€šä¹‰åƒé—® | [dashscope.console.aliyun.com](https://dashscope.console.aliyuncs.com/) | [æ–‡æ¡£](https://help.aliyun.com/document_detail/2400395.html) |
| Moonshot | [platform.moonshot.cn](https://platform.moonshot.cn/) | [æ–‡æ¡£](https://platform.moonshot.cn/docs) |
| Ollama | [ollama.ai](https://ollama.ai/) | [æ–‡æ¡£](https://github.com/ollama/ollama) |

## é»˜è®¤ API ç«¯ç‚¹

ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ªæä¾›å•†å¡«å……é»˜è®¤çš„ API Base URL:

```typescript
openai:     https://api.openai.com/v1
anthropic:  https://api.anthropic.com
deepseek:   https://api.deepseek.com/v1
zhipu:      https://open.bigmodel.cn/api/paas/v4
qwen:       https://dashscope.aliyuncs.com/compatible-mode/v1
moonshot:   https://api.moonshot.cn/v1
ollama:     http://localhost:11434/v1
```

## ä½¿ç”¨ä»£ç†æœåŠ¡

å¦‚æœä½ ä½¿ç”¨ç¬¬ä¸‰æ–¹ä»£ç†æœåŠ¡ (å¦‚ OneAPI, New API ç­‰),å¯ä»¥ä¿®æ”¹ API Base URL:

```
ç¤ºä¾‹: https://api.your-proxy.com/v1
```

## æœ¬åœ° Embedding

æœ¬åœ° Embedding ä½¿ç”¨ BGE æ¨¡å‹,æ— éœ€ API Key å³å¯ä½¿ç”¨:

- **æ¨¡å‹**: BAAI/bge-large-zh-v1.5
- **è®¾å¤‡**: CPU æˆ– CUDA (åœ¨åç«¯ .env ä¸­é…ç½®)
- **ç‰¹ç‚¹**: å…è´¹ã€éšç§ä¿æŠ¤ã€æ— ç½‘ç»œä¾èµ–

## ç•Œé¢æˆªå›¾

### æ¨¡å‹é…ç½®ä¸»é¡µ

![æ¨¡å‹é…ç½®é¡µé¢](./docs/images/model-providers.png)

å±•ç¤ºæ‰€æœ‰å¯ç”¨çš„æ¨¡å‹æä¾›å•†,ä»¥å¡ç‰‡å½¢å¼å‘ˆç°,åŒ…å«:
- å“ç‰Œå›¾æ ‡ (å®˜æ–¹ SVG)
- æä¾›å•†åç§°å’Œæè¿°
- å¯ç”¨æ¨¡å‹åˆ—è¡¨
- é…ç½®çŠ¶æ€æŒ‡ç¤ºå™¨

### é…ç½®å¯¹è¯æ¡†

![é…ç½®å¯¹è¯æ¡†](./docs/images/config-dialog.png)

åŒ…å«:
- API Key è¾“å…¥ (æ”¯æŒæ˜¾ç¤º/éšè—)
- API Base URL é…ç½®
- é«˜çº§å‚æ•°è®¾ç½® (Temperature, Max Tokens, Timeout)
- è¿æ¥æµ‹è¯•åŠŸèƒ½
- ä¸€é”®ä¿å­˜

## æŠ€æœ¯å®ç°

### ç»„ä»¶ç»“æ„

```
components/
â”œâ”€â”€ provider-icon.tsx           # å“ç‰Œå›¾æ ‡ç»„ä»¶ (SVG)
â”œâ”€â”€ model-provider-card.tsx     # æä¾›å•†å¡ç‰‡
â””â”€â”€ model-config-dialog.tsx     # é…ç½®å¯¹è¯æ¡†

types/
â””â”€â”€ models.ts                   # æ¨¡å‹ç±»å‹å®šä¹‰å’Œé…ç½®æ•°æ®

app/
â””â”€â”€ settings/
    â””â”€â”€ page.tsx                # è®¾ç½®é¡µé¢
```

### ç±»å‹å®šä¹‰

```typescript
interface ModelProvider {
  id: string
  name: string
  description: string
  icon: string
  color: string
  isConfigured: boolean
  models: ModelConfig[]
  config?: ProviderConfig
}
```

## å¸¸è§é—®é¢˜

### Q: é…ç½®å¤šä¸ªæä¾›å•†ä¼šå†²çªå—?
A: ä¸ä¼š,æ¯ä¸ªæä¾›å•†çš„é…ç½®æ˜¯ç‹¬ç«‹çš„,ä½ å¯ä»¥åŒæ—¶é…ç½®å¤šä¸ªå¹¶åœ¨ä½¿ç”¨æ—¶é€‰æ‹©ã€‚

### Q: API Key ä¼šä¿å­˜åœ¨å“ªé‡Œ?
A: å½“å‰å­˜å‚¨åœ¨æµè§ˆå™¨çš„çŠ¶æ€ä¸­ã€‚åç»­ç‰ˆæœ¬ä¼šæ”¯æŒ:
- LocalStorage æŒä¹…åŒ–
- åç«¯åŠ å¯†å­˜å‚¨
- ç¯å¢ƒå˜é‡é…ç½®

### Q: å¦‚ä½•åˆ‡æ¢ä½¿ç”¨ä¸åŒçš„æ¨¡å‹?
A: åœ¨å¯¹è¯é¡µé¢ä¼šæœ‰æ¨¡å‹é€‰æ‹©å™¨,å¯ä»¥ä»å·²é…ç½®çš„æä¾›å•†ä¸­é€‰æ‹©å…·ä½“æ¨¡å‹ã€‚

### Q: Ollama éœ€è¦ç‰¹æ®Šé…ç½®å—?
A: éœ€è¦å…ˆåœ¨æœ¬åœ°å®‰è£…å¹¶å¯åŠ¨ Ollama æœåŠ¡:
```bash
# å®‰è£… Ollama
curl -fsSL https://ollama.ai/install.sh | sh

# ä¸‹è½½æ¨¡å‹
ollama pull llama2

# æœåŠ¡ä¼šè‡ªåŠ¨è¿è¡Œåœ¨ http://localhost:11434
```

## åç»­è§„åˆ’

- [ ] é…ç½®æŒä¹…åŒ– (LocalStorage + åç«¯)
- [ ] æ‰¹é‡å¯¼å…¥/å¯¼å‡ºé…ç½®
- [ ] æˆæœ¬ç»Ÿè®¡å’Œé…é¢ç®¡ç†
- [ ] æ¨¡å‹æ€§èƒ½å¯¹æ¯”
- [ ] æ”¯æŒæ›´å¤šæä¾›å•† (Gemini, Azure OpenAI ç­‰)
- [ ] è‡ªåŠ¨æ£€æµ‹å¯ç”¨æ¨¡å‹åˆ—è¡¨

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ PR æ·»åŠ æ›´å¤šæ¨¡å‹æä¾›å•†! è¯·å‚è€ƒç°æœ‰ä»£ç ç»“æ„:

1. åœ¨ `types/models.ts` ä¸­æ·»åŠ æä¾›å•†é…ç½®
2. åœ¨ `components/provider-icon.tsx` ä¸­æ·»åŠ å®˜æ–¹å›¾æ ‡
3. æµ‹è¯•é…ç½®æµç¨‹æ˜¯å¦æ­£å¸¸

---

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®,è¯·åœ¨ GitHub Issues ä¸­åé¦ˆã€‚
